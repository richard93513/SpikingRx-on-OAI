# ğŸ“„ OAI â†’ Full-grid Dump â†’ SpikingRx å…¨æµç¨‹ï¼ˆA4 æœ€ç°¡ç‰ˆï¼‰

ä»¥ä¸‹æ‰€æœ‰æŒ‡ä»¤éƒ½ä¾ç…§ä½ çš„å¯¦éš›è·¯å¾‘ã€å¯¦éš› pipelineã€å¯¦éš›ç¿’æ…£æ’°å¯«ã€‚

---

## ï¼ˆAï¼‰ç·¨è­¯ OAIï¼ˆgNB + UEï¼‰

### 1. æ¸…é™¤èˆŠ buildï¼ˆé¿å…ç‰ˆæœ¬è¡çªï¼‰
```
cd ~/openairinterface5g/cmake_targets/ran_build/build
rm -rf CMakeCache.txt CMakeFiles
```

### 2. é‡æ–°ç·¨è­¯ï¼ˆSIMU / RFsim æ¨¡å¼ï¼‰
```
cd ~/openairinterface5g/cmake_targets
./build_oai --gNB --nrUE -w SIMU
```

---

## ï¼ˆBï¼‰å•Ÿå‹• gNBï¼ˆRFsim æ¨¡å¼ï¼‰
```
cd ~/openairinterface5g
source oaienv
cd cmake_targets/ran_build/build

./nr-softmodem \
  -O ../../../targets/PROJECTS/GENERIC-NR-5GC/CONF/gnb.sa.band78.fr1.106PRB.usrpb210.conf \
  --rfsim \
  --gNBs.[0].min_rxtxtime 6
```

---

## ï¼ˆCï¼‰å•Ÿå‹• UEï¼ˆRFsim æ¨¡å¼ï¼‰
```
cd ~/openairinterface5g
source oaienv
cd cmake_targets/ran_build/build

./nr-uesoftmodem \
  --rfsim \
  -r 106 --numerology 1 --band 78 -C 3619200000
```

---

## ï¼ˆDï¼‰ç¢ºèª OAI Full-grid dump æ˜¯å¦ç”¢ç”Ÿ
ï¼ˆOAI å·²ç¶“ä¿®æ”¹éï¼ŒæŠŠ FFT è³‡æ–™å­˜åˆ° `/tmp/`ï¼‰

### 1. æª¢æŸ¥ dump æª”æ¡ˆåˆ—è¡¨
```
ls -ltr /tmp/spx_fullgrid_*.bin
```

### 2. ç”¨ xxd çœ‹å‰ 32 bytesï¼ˆç¢ºèªæ˜¯å¦æ­£å¸¸ complex16ï¼‰
```
xxd -g2 -l 32 /tmp/spx_fullgrid_f902_s1.bin
```

ï¼ˆä½ é€šå¸¸çœ‹åˆ° `00 00 00 00 ...` é–‹é ­ï¼Œè¡¨ç¤º FFT å‰å¹¾å€‹ RE æ˜¯ 0ï¼‰

---

## ï¼ˆEï¼‰è·‘ SpikingRx æ¨è«–ï¼ˆForward Inferenceï¼‰

### 1. å•Ÿå‹•å°ˆæ¡ˆç’°å¢ƒ
```
cd ~/SpikingRx-on-OAI
source .venv/bin/activate
```

### 2. è·‘ inferenceï¼ˆè‡ªå‹•è®€ dumpã€è‡ªå‹•è½‰ 32Ã—32ã€è‡ªå‹• forwardï¼‰
```
python src/inference/run_spikingrx_on_oai_dump.py
```

### è¼¸å‡ºçµæœå­˜æ”¾
```
src/inference/out/
    â”œâ”€â”€ llr.npy
    â”œâ”€â”€ llr_heatmap.png
    â””â”€â”€ spike_rate.png
```

---

## ï¼ˆFï¼‰è¨“ç·´ SpikingRx
```
cd ~/SpikingRx-on-OAI
python src/train/train_spikingrx.py
```

### æ¨¡å‹ checkpoint å­˜æ”¾
```
checkpoints/spikingrx_checkpoint.pth
```

### è¨“ç·´æ›²ç·šèˆ‡ logï¼š
```
docs/results/train/
    â”œâ”€â”€ loss_curve.png
    â””â”€â”€ loss_history.npy
```

---

## ï¼ˆGï¼‰è¨“ç·´å¾Œå†æ¬¡æ¨è«–ï¼ˆè¼‰å…¥ checkpointï¼‰
```
cd ~/SpikingRx-on-OAI
python src/inference/run_spikingrx_on_oai_dump.py
```

ï¼ˆæœƒè‡ªå‹•è®€å– `checkpoints/spikingrx_checkpoint.pth`ï¼‰

---

## ï¼ˆHï¼‰å¯è¦–åŒ–ï¼ˆé¸ç”¨ï¼‰
```
python src/visualize/visualize_spiking_activity.py
```

### è¼¸å‡º
```
docs/results/visualize/
```

---
