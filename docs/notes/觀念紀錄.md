
# SpikingRx — Slot-based SNN Receiver 技術理解筆記


# ⭐ 1. 單 Slot 作為 SpikingRx 的輸入

## ✔ 1.1 5G NR 中，一個 slot 的原始結構  
以 30 kHz SCS 為例：

- 一個 slot = **14 個 OFDM symbols**
- 每個 symbol = **1272 subcarriers（106RB）**
- 每個 RE（resource element）是 complex（I/Q）

原始資料為：

(14 symbols, 1272 subcarriers, complex)

---

## ✔ 1.2 SpikingRx 要固定尺寸，因此壓成 32×32  
處理方式：

| 維度 | 處理方式 |
|------|----------|
| 14 symbols | 壓或補成 32 rows |
| 1272 subcarriers | 壓成 32 cols |
| I/Q | 當成 2 channels |

最終模型輸入一個 slot：

(2, 32, 32)

---

## ✔ 1.3 SpikingRx input tensor 形狀  

模型接收：

(1, T=5, C=2, H=32, W=32)

- batch=1  
- **C=2：I 與 Q**  
- H×W = 32×32（slot 映射成的二維影像）  
- **T=5：LIF neuron 的 temporal unroll（不是多張影像）**

---

# ⭐ 2. CNN 與 SNN 如何處理 slot？

---

# 🟦 2.1 第一層 Conv 的實際輸入只有 I/Q  
Conv 的 input 是：

(2,32,32)

= 一張 two-channel 影像。

---

# 🟦 2.2 T=5 是什麼？不是五張圖片的複製  
T=5 表示：

> **同一張 feature map 在 LIF neuron 中進行 5 個時間步的膜電位與 spike 演化。**

也就是：

for t in 1..5:
    v[t] = β·v[t-1] + input_current
    spike[t] = v[t] > θ

- CNN 是空間特徵  
- LIF 是時間特徵  
- SNN = CNN + recurrent membrane dynamics

---

# ⭐ 3. 每個 RE 是否對應一個 LIF neuron？

## ✔ 是  
32×32 = 1024 個位置  
每個 channel 位置對應一個 spiking neuron。

每個 neuron 有：

- 自己的 membrane potential  
- 自己的 spike(t)  
- 在 T=5 時間步同步演化  

因此：

> **每個 RE（壓縮後的 pixel）都是一顆獨立的 LIF neuron，獨立演化但同步計算。**

---

# ⭐ 4. LLR 是如何由整個 slot 決定的？

不是取最大最小，不是 normalization。

流程：

## ✔ 4.1 全局特徵抽取  
整張 slot 的 32×32×C feature maps 經過：

CNN → LIF(T=5) → SEW Blocks → spike-rate map

## ✔ 4.2 Rate pooling  
將每顆 neuron 的 5 個時間步 spike count：

rate = spike.sum(dim=T)

## ✔ 4.3 ANN readout → LLR  
Flatten → fc1 → ReLU → fc2 → [LLR_bit0, LLR_bit1]

也就是：

> **整張 slot 的 spiking feature map 經 ANN 映射成兩個 LLR scalar。**

不是看某個 pixel，也不是最大最小，而是高維映射。

---

# ⭐ 5. OFDM 一個 slot 是否可能包含多種調變方式？

## ✔ 真實 5G NR：會  
不同 RB 分配給不同 user → modulation 可能不同（QPSK/16QAM/64QAM 混合）

## ✔ OAI：支援 multi-user、多 RNTI、多 MCS  
（但需手動設定或使用 MAC scheduler）

## ✔ 你目前的 rfsim 實驗：單 UE / SISO  
因此：

- 只有一個 RNTI  
- modulation 整張 BWP 一致（例如全 QPSK）  
- 不會有多種 modulation 混在同一個 slot

---

# ⭐ 最終總結（可直接對教授講）

> 我現在的 SpikingRx 是 slot-based SNN receiver。  
> 一個 slot 的 14×1272 resource grid 映射成固定大小的 32×32 I/Q feature map。  
> CNN 負責空間特徵，LIF neuron 在 T=5 時間步對每個像素（每個 RE）進行膜電位演化，因此 32×32 位置各對應一顆獨立的 spiking neuron。  
> 最後的 spike-rate map 經 ANN readout 得到整個 codeword 的 bit-wise LLR。  
>  
> 目前 rfsim 是單 UE/SISO，因此整張 slot 的 modulation 一致，不會有 multi-user 多 MCS 混合的問題。
